<template>
  <!-- <MobileAddMemberForm v-show="$device.mobile" ref="m"></MobileAddMemberForm> -->
  <div>
    <swipeable-bottom-sheet
      v-if="$device.mobile"
      ref="swipeableBottomSheet"
      style="z-index:2000"
      v-on:close="beforeClose()"
    >
      <component
        v-bind:is="selectedComponent"
        :gender="gender"
        :type="this.type"
        :parent_id="this.parent_id"
        :memData="this.memData"
        :name="this.componentParams"
        v-on:close="swiperClose()"
      ></component>
    </swipeable-bottom-sheet>
  </div>
</template>

<script>
import AddFamily from "../components/AddFamilyForm.vue";
import AddRoot from "../components/AddRootForm";
import AddMemberForm from "../components/AddMemberForm";
import DeleteMember from "../components/DeleteMember";
import SwipeableBottomSheet from "../components/t-party/SwipeableBottomSheet";

export default {
  props: ["reference", "gender", "type", "parent_id", "memData", "componentParams"],
  components: {
    SwipeableBottomSheet
  },
  data() {
    return {
      component: [AddFamily, AddRoot, AddMemberForm, DeleteMember],
      selectedComponent: ""
    };
  },
  mounted() {
    this.selectedComponent = this.component[this.reference];
    if (this.$device.mobile) {
      setTimeout(() => {
        this.$refs.swipeableBottomSheet.setState("open");
      },200);
    } else {
      this.$modal.show(
        this.selectedComponent,
        {
          gender: this.gender,
          type: this.type,
          parent_id: this.parent_id,
          memData: this.memData,
          name : this.componentParams
        },
        {
          height: "auto",
          draggable: true,
          clickToClose: false,
          scrollable: true
        },
        {
          "before-close": this.beforeClose
        }
      );
    }
  },
  methods: {
    beforeClose() {
      this.$emit("closed");
    },
    swiperClose(){
      this.$refs.swipeableBottomSheet.setState("close");
      setTimeout(() => {
        this.beforeClose();
      },500);
    }
  }
};
</script>